<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="AMP website featuring the latest videos, announcements, and social media links." />
    <meta name="keywords" content="AMP, YouTube, fan site, AMP members, AMP videos, AMP announcements, Duke Dennis, Kai Cenat, Fanum, Agent 00, chrisnxtdoor, ImDavis, ampexclusive,AMPexclusive, ampexclusivehub" />
    <meta name="author" content="Joshua Deville"/>
    <title>AMP HOME</title>
    <link rel="stylesheet" href="css/index.css"/>
    <link rel="icon" href="images/otherAmpLogo.ico">
  </head>
  <body>
    <!-- navbar (from lines 10 - 16) -->
    <header>
      <a href="index.html"><img class="logo" src="images/ampGif.gif" alt="AMP Logo" width="55" height="55"/></a>
      <button class="hamburger" aria-label="Open navigation menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <nav>
        <ul class="navLinks">
          <li><a class="active" href="index.html">AMP HOME</a></li>
          <li><a href="html/pages/ampAbout.html">AMP ABOUT</a></li>
          <li><a href="html/pages/ampMembers.html">AMP MEMBERS</a></li>
          <li><a href="html/pages/ampVideoGallery.html">AMP VIDEO GALLERY</a></li>
          <li> <a href="https://amp.shop/?srsltid=AfmBOooL_I4fxnrD873vIpm4juyU7GcVvSacJzszHo7vcpJd3XmJgWRy" target="_blank">AMP SHOP</a></li>
        </ul>
      </nav>
  </header>
  

    <!-- side content for users to watch the recent video (lines 19-20) -->
    <div class="container">
      <div class="contentRow">
        <div class="recentVid">
          <h2>Watch The Most Recent AMP Video</h2>
          <iframe src="https://www.youtube.com/embed/5l8rppKI3og?si=vS2s80aDNDxL7I61" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
        </div>
        <!-- side Content as well for announcements (lines 22-26) -->
        <div class="announcements"> 
          <h2>Announcements</h2>
          <ul>
            <li>TONE is Out Now!</li>
            <li>Mafiathon Starts 6pm EST</li>
            <li>Countdown Until Next AMP Video: TBD</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- first footer for twitch status (should be six small coloumns) and countdown (lines 20-38) -->
    <div class="statusContainer">
      <h3>Twitch Status</h3>
      <ul id="twitchStatusList">
        <li id="duke-status">
          <span class="live-indicator offline"></span>
          <span class="streamer-name">Duke</span>
          <span class="status-text">is not</span>
          <a href="https://www.twitch.tv/duke" target="_blank">Live</a>
        </li>
        <li id="kai-status">
          <span class="live-indicator offline"></span>
          <span class="streamer-name">Kai</span>
          <span class="status-text">is not</span>
          <a href="https://www.twitch.tv/kaicenat" target="_blank">Live</a>
        </li>
        <li id="chris-status">
          <span class="live-indicator offline"></span>
          <span class="streamer-name">Chris</span>
          <span class="status-text">is not</span>
          <a href="https://www.twitch.tv/chrisnxtdoor" target="_blank">Live</a>
        </li>
        <li id="agent-status">
          <span class="live-indicator offline"></span>
          <span class="streamer-name">Agent</span>
          <span class="status-text">is not</span>
          <a href="https://twitch.tv/agent00" target="_blank">Live</a>
        </li>
        <li id="fanum-status">
          <span class="live-indicator offline"></span>
          <span class="streamer-name">Fanum</span>
          <span class="status-text">is not</span>
          <a href="https://www.twitch.tv/fanum" target="_blank">Live</a>
        </li>
        <li id="davis-status">
          <span class="live-indicator offline"></span>
          <span class="streamer-name">Davis</span>
          <span class="status-text">is not</span>
          <a href="https://www.twitch.tv/davis" target="_blank">Live</a>
        </li>
      </ul>
  </div>

    <!-- Sceond footer for AMP Socials-->
    <footer>
      <h3>AMP Socials</h3>
      <ul class="socials">
        <li>
          <a href="https://www.youtube.com/@AMPEXCLUSIVE" target="_blank">
            <img src="images/youtubeLogo.svg" width="35" height="35" alt="Youtube Logo" />
          </a>
        </li>
        <li>
          <a href="https://www.instagram.com/ampexclusive/" target="_blank">
            <img src="images/instagramLogo.svg" height="35" width="35" alt="Instagram Logo" />
          </a>
        </li>
        <li>
          <a href="https://x.com/AMPexclusive" target="_blank">
            <img src="images/xLogo.svg" width="35" height="35" alt="X Logo" />
          </a>
        </li>
        <li>
          <a href="https://www.tiktok.com/@ampexclusive6" target="_blank">
            <img src="images/tikTokLogo.svg" width="35" height="35" alt="Tiktok Logo" />
          </a>
        </li>
      </ul>
      <p>This is an unofficial fan concept website for AMP, created as a design and development project. AMP retains all rights to its name, logos, and content.</p>
    </footer>

    <script>
      // Hamburger menu toggle
      const hamburger = document.querySelector('.hamburger');
      const navLinks = document.querySelector('.navLinks');
      hamburger.addEventListener('click', () => {
        navLinks.classList.toggle('open');
        hamburger.classList.toggle('open');
      });

      // Twitch API Configuration
      const TWITCH_CLIENT_ID = 'ejotik1ay38gwhf6srhkhao5o4jgz5'; // Replace with your new Client ID
      const TWITCH_CLIENT_SECRET = '51x40oxdv5lfnjkv8h4c1bnx8425bp'; // Replace with your new Client Secret
      const TWITCH_API_BASE = 'https://api.twitch.tv/helix';
      
      // Function to get OAuth token for confidential client
      async function getTwitchToken() {
        try {
          const response = await fetch('https://id.twitch.tv/oauth2/token', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: `client_id=${TWITCH_CLIENT_ID}&client_secret=${TWITCH_CLIENT_SECRET}&grant_type=client_credentials`
          });
          
          if (!response.ok) {
            throw new Error(`Token request failed: ${response.status}`);
          }
          
          const data = await response.json();
          return data.access_token;
        } catch (error) {
          console.error('Error getting Twitch token:', error);
          return null;
        }
      }
      
      // Streamer configuration
      const streamers = {
        'duke': { username: 'duke', displayName: 'Duke', elementId: 'duke-status' },
        'kaicenat': { username: 'kaicenat', displayName: 'Kai', elementId: 'kai-status' },
        'chrisnxtdoor': { username: 'chrisnxtdoor', displayName: 'Chris', elementId: 'chris-status' },
        'agent00': { username: 'agent00', displayName: 'Agent', elementId: 'agent-status' },
        'fanum': { username: 'fanum', displayName: 'Fanum', elementId: 'fanum-status' },
        'davis': { username: 'davis', displayName: 'Davis', elementId: 'davis-status' }
      };

      // Function to check live status for all streamers
      async function checkTwitchStatus() {
        try {
          // Get OAuth token first
          const token = await getTwitchToken();
          if (!token) {
            throw new Error('Failed to get OAuth token');
          }
          
          // Get all streamer usernames
          const usernames = Object.keys(streamers);
          const userLogins = usernames.map(username => `user_login=${username}`).join('&');
          
          // Make API request to check live status
          const apiUrl = `${TWITCH_API_BASE}/streams?${userLogins}`;
          console.log('Checking Twitch API:', apiUrl);
          
          const response = await fetch(apiUrl, {
            headers: {
              'Client-ID': TWITCH_CLIENT_ID,
              'Authorization': `Bearer ${token}`,
              'Accept': 'application/vnd.twitchtv.v5+json'
            }
          });

          console.log('API Response status:', response.status);

          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }

          const data = await response.json();
          console.log('API Response data:', data);
          const liveStreams = data.data || [];

          // Create a map of live streamers
          const liveStreamers = new Set();
          liveStreams.forEach(stream => {
            liveStreamers.add(stream.user_login);
          });

          // Update each streamer's status
          Object.values(streamers).forEach(streamer => {
            updateStreamerStatus(streamer, liveStreamers.has(streamer.username));
          });

        } catch (error) {
          console.error('Error checking Twitch status:', error);
          // On error, show all as offline
          Object.values(streamers).forEach(streamer => {
            updateStreamerStatus(streamer, false, true);
          });
        }
      }

      // Function to update individual streamer status
      function updateStreamerStatus(streamer, isLive, isError = false) {
        const element = document.getElementById(streamer.elementId);
        if (!element) return;

        const liveIndicator = element.querySelector('.live-indicator');
        const statusText = element.querySelector('.status-text');
        const liveLink = element.querySelector('a');

        if (isError) {
          // Error state - show as offline with error styling
          liveIndicator.className = 'live-indicator error';
          statusText.textContent = 'is not';
          liveLink.textContent = 'Live';
          element.classList.remove('live');
          element.classList.add('error');
        } else if (isLive) {
          // Live state
          liveIndicator.className = 'live-indicator live';
          statusText.textContent = 'is';
          liveLink.textContent = 'LIVE';
          element.classList.add('live');
          element.classList.remove('offline');
        } else {
          // Offline state
          liveIndicator.className = 'live-indicator offline';
          statusText.textContent = 'is not';
          liveLink.textContent = 'Live';
          element.classList.add('offline');
          element.classList.remove('live');
        }
      }

      // Initialize and start checking
      document.addEventListener('DOMContentLoaded', function() {
        // Check immediately on page load
        checkTwitchStatus();
        
        // Then check every minute (60000ms)
        setInterval(checkTwitchStatus, 60000);
      });
    </script>
  </body>
</html>
